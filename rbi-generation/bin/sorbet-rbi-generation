#!/usr/bin/env ruby

module SorbetRBIGeneration; end

require_relative '../lib/sorbet'
require_relative '../lib/gem-generator-tracepoint'
require_relative '../lib/hidden-method-finder'
require_relative '../lib/fetch-rbis'
require_relative '../lib/suggest-typed'

module SorbetRBIGeneration::Main
  def self.main
    puts "This script should take a few minutes and will print all sorts of things. If it errors you probably care most about the last few lines."

    # Pull in the hand-written RBIs
    SorbetRBIGeneration::FetchRBIs.main

    # Generate the RBIs from bundler
    SorbetRBIGeneration::GemGeneratorTracepoint.main

    # Find the hidden methods
    SorbetRBIGeneration::HiddenMethodFinder.main

    # Put some `typed:` sigils
    SorbetRBIGeneration::SuggestTyped.main

    puts "This script has probably generated many changed files in your current directory. Please commit them all. The typechecker will make sure they are all still valid."
  end
end

SorbetRBIGeneration::Main.main
